<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<!--
This software and related documentation are proprietary to Siemens Product Lifecycle Management Software Inc.

(c) 2013 Siemens Product Lifecycle Management Software Inc. All Rights Reserved. 

All trademarks belong to their respective holders.
-->
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>sql</title>
      
      <meta name="MS-HKWD" content="sql">
      <meta name="MS-HKWD" content="sql,ODBC">
      
      <link type="text/css" href="css/base.css" rel="stylesheet">
   </head>
   <body class="bodydocs" bgcolor="#FFFFFF">
      <div class="title_topic5" id="xps10_pagetitle">sql</div>
      <hr noshade="true">
      <div class="insideNavLinks"><span><a class="link" href="id73151.html"><img border="0" src="../../../../../../icons/previous.gif" title="Previous Page:rollbackTrans"></a><a class="link" href="id83956.html"><img border="0" src="../../../../../../icons/next.gif" title="Next Page:sqlError"></a></span></div>
      <table align="center" class="simpleHTMLminitoc" width="95%">
         <tr>
            <td class="simpleHTMLminitoc"><span class="simpleHTMLminitoc"><a href="id25448.html">Add-Ins Reference Help</a></span> &gt; <span class="simpleHTMLminitoc"><a href="id36445.html">Database Interfaces</a></span> &gt; <span class="simpleHTMLminitoc"><a href="id92182.html">ODBC</a></span> &gt; <span class="simpleHTMLminitoc"><a href="id88011.html">Methods of the ODBC Interface</a></span> &gt; <span class="simpleHTMLminitoc">sql</span></td>
         </tr>
      </table>
      <div class="contentType_"><span id="ndxgenid_PlantSimulationENU_15208"></span><table bgcolor="#FFFFFF" border="1" cellpadding="2" cellspacing="1">
            
            <colgroup span="1">
               
               <col span="1" width="100%">
               
            </colgroup>
            
            <tbody>
               
               <tr>
                  
                  <td colspan="1" rowspan="1">
                     
                     <table bgcolor="#FFFFFF" cellpadding="2" cellspacing="1" align="center">
                        
                        <tbody>
                           
                           <tr valign="top">
                              
                              <td colspan="1" rowspan="1" width="85">
                                 
                                 <p class="para_td_last"><b class="uiTerm">Syntax:</b></p>
                                 
                              </td>
                              
                              <td colspan="1" rowspan="1" width="500">
                                 <pre class="indent">Path.sql(Result:table, SQLString:string)
Path.sql(Result:table, SQLString:string [,SQLParameter:any, ...])</pre>
                                 </td>
                              
                           </tr>
                           
                        </tbody>
                        
                     </table>
                     
                  </td>
                  
               </tr>
               
            </tbody>
            
         </table>
         <p class="para_topic">The method <em>sql</em> controls the actual communication with the data source. You can invoke this method within SimTalk, the information flow language of <em>Plant Simulation</em>. It sends SQL statements to an ODBC driver.
         </p>
         <table bgcolor="#FFFFFF" border="1" cellpadding="2" cellspacing="1">
            
            <colgroup span="1">
               
               <col span="1" width="100%">
               
            </colgroup>
            
            <tbody>
               
               <tr>
                  
                  <td colspan="1" rowspan="1">
                     
                     <table bgcolor="#FFFFFF" cellpadding="2" cellspacing="1" align="center">
                        
                        <tbody>
                           
                           <tr valign="top">
                              
                              <td colspan="1" rowspan="1" width="85">
                                 
                                 <p class="para_td_last"><b class="uiTerm">Example:</b></p>
                                 
                              </td>
                              
                              <td colspan="1" rowspan="1" width="500">
                                 <pre class="indent">ODBC.insertTable(TableFile,&quot;Name_of_Table&quot;)
ODBC.sql(&quot;deletefromxyz&quot;)</pre>
                                 </td>
                              
                           </tr>
                           
                        </tbody>
                        
                     </table>
                     
                  </td>
                  
               </tr>
               
            </tbody>
            
         </table>
         <p class="para_topic">If an SQL command returns a result, the first parameter in the method call must define a <em>table</em> that is to receive the data. The format of this <em>table</em> (number of columns, column index, data type of the column) depends on the result of the <em>SELECT </em> query <em></em> and is generated automatically. The list editor of <em>Plant Simulation</em> shows the list immediately. The data in the list is available for further use in the simulation model. 
         </p>
         <table bgcolor="#FFFFFF" border="1" cellpadding="2" cellspacing="1">
            
            <colgroup span="1">
               
               <col span="1" width="100%">
               
            </colgroup>
            
            <tbody>
               
               <tr>
                  
                  <td colspan="1" rowspan="1">
                     
                     <table bgcolor="#FFFFFF" cellpadding="2" cellspacing="1" align="center">
                        
                        <tbody>
                           
                           <tr valign="top">
                              
                              <td colspan="1" rowspan="1" width="85">
                                 
                                 <p class="para_td_last"><b class="uiTerm">Example:</b></p>
                                 
                              </td>
                              
                              <td colspan="1" rowspan="1" width="500">
                                 <pre class="indent">.ODBC.sql(table,&quot;select * from xyz&quot;)</pre>
                                 </td>
                              
                           </tr>
                           
                        </tbody>
                        
                     </table>
                     
                  </td>
                  
               </tr>
               
            </tbody>
            
         </table>
         <p class="para_topic">To increase the flexibility of the calls program variables can be included in the SQL command. The representation of program variables in the SQL statement are determined by conversion specifications which begin with the percent sign %.</p>
         <p class="para_topic">A conversion specification has this format:</p><pre class="indent">%[flags][field format&gt;]conversion signs</pre><p class="para_topic">The items of the conversion specification can accept these values:</p><pre class="indent">flags:
   -: left bound representation of the program variable
   +: display of the sign also if the program variable is positive
field format: field length.decimal digits 
&lt;conversion signs:
   s: string
   d: integer 
   u: positive integer
   o: octal 
   x: hexadecimal
   f: floating point</pre><p class="para_topic">If you do not want <em>Plant Simulation</em> to interpret the percentage sign % as a control character, enter two percentage signs %<code>%</code>. Each conversion specification is assigned to one parameter, which follows the SQL command. In this example, the data base table xyz is accessed and entries from the column <em>name</em> are passed to the SQL command and are put in the <em>Plant Simulation</em> table file <em>dataInput.</em></p>
         <p class="para_topic"><b class="uiTerm">Return Value</b></p>
         <p class="para_topic">The return value has the data type <em>integer</em>. 
         </p>
         <table bgcolor="#FFFFFF" border="1" cellpadding="2" cellspacing="1">
            
            <colgroup span="1">
               
               <col span="1" width="100%">
               
            </colgroup>
            
            <tbody>
               
               <tr>
                  
                  <td colspan="1" rowspan="1">
                     
                     <table bgcolor="#FFFFFF" cellpadding="2" cellspacing="1" align="center">
                        
                        <tbody>
                           
                           <tr valign="top">
                              
                              <td colspan="1" rowspan="1" width="85">
                                 
                                 <p class="para_td_last"><b class="uiTerm">Example:</b></p>
                                 
                              </td>
                              
                              <td colspan="1" rowspan="1" width="500">
                                 <pre class="indent">var uid : integer
var type : string
uid := 1
type := &quot;U&quot;
.ODBC.sql(dataInput, &quot;SELECT name FROM xyz WHERE\
uid = %d AND type = '%s'&quot;, uid, type)</pre>
                                 </td>
                              
                           </tr>
                           
                        </tbody>
                        
                     </table>
                     
                  </td>
                  
               </tr>
               
            </tbody>
            
         </table>
         <p class="para_topic">In this example, data from <em>Plant Simulation</em> is written into a data base.
         </p>
         <table bgcolor="#FFFFFF" border="1" cellpadding="2" cellspacing="1">
            
            <colgroup span="1">
               
               <col span="1" width="100%">
               
            </colgroup>
            
            <tbody>
               
               <tr>
                  
                  <td colspan="1" rowspan="1">
                     
                     <table bgcolor="#FFFFFF" cellpadding="2" cellspacing="1" align="center">
                        
                        <tbody>
                           
                           <tr valign="top">
                              
                              <td colspan="1" rowspan="1" width="85">
                                 
                                 <p class="para_td_last"><b class="uiTerm">Example:</b></p>
                                 
                              </td>
                              
                              <td colspan="1" rowspan="1" width="500">
                                 <pre class="indent">var uid : integer
var type : string
uid := 5
t ype := &quot;Z&quot;
.ODBC.sql(&quot;UPDATE xyz SET type = '%s' WHERE\
uid = %d&quot;, type, uid)</pre>
                                 </td>
                              
                           </tr>
                           
                        </tbody>
                        
                     </table>
                     
                  </td>
                  
               </tr>
               
            </tbody>
            
         </table>
      </div>
      <div class="insideNavLinks"><span><a class="link" href="id73151.html"><img border="0" src="../../../../../../icons/previous.gif" title="Previous Page:rollbackTrans"></a><a class="link" href="id83956.html"><img border="0" src="../../../../../../icons/next.gif" title="Next Page:sqlError"></a></span></div>
   </body>
</html>