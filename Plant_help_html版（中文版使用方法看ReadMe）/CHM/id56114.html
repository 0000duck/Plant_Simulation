<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<!--
This software and related documentation are proprietary to Siemens Product Lifecycle Management Software Inc.

(c) 2013 Siemens Product Lifecycle Management Software Inc. All Rights Reserved. 

All trademarks belong to their respective holders.
-->
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Import Data into Your Simulation Model</title>
      
      <meta name="MS-HKWD" content="Import Data into Your Simulation Model">
      
      <link type="text/css" href="css/base.css" rel="stylesheet">
   </head>
   <body class="bodydocs" bgcolor="#FFFFFF">
      <div class="title_topic6" id="xps10_pagetitle">Import Data into Your Simulation Model</div>
      <hr noshade="true">
      <div class="insideNavLinks"><span><a class="link" href="id91507.html"><img border="0" src="../../../../../../icons/previous.gif" title="Previous Page:Set the Data Source Up"></a><a class="link" href="id36348.html"><img border="0" src="../../../../../../icons/next.gif" title="Next Page:Export Data to the Database"></a></span></div>
      <table align="center" class="simpleHTMLminitoc" width="95%">
         <tr>
            <td class="simpleHTMLminitoc"><span class="simpleHTMLminitoc"><a href="id13814.html">Step-by-Step Help</a></span> &gt; <span class="simpleHTMLminitoc"><a href="id96132.html">Importing Data for the Simulation</a></span> &gt; <span class="simpleHTMLminitoc"><a href="id48998.html">Importing and Exporting Data</a></span> &gt; <span class="simpleHTMLminitoc"><a href="id24466.html">Import Data from a Database</a></span> &gt; <span class="simpleHTMLminitoc"><a href="id37636.html">Import Data from an ODBC Database</a></span> &gt; <span class="simpleHTMLminitoc">Import Data into Your Simulation Model</span></td>
         </tr>
      </table>
      <div class="contentType_"><span id="ndxgenid_PlantSimulationENU_1659"></span><p class="para_topic">After setting-up the ODBC data source, you have to insert the object <em>ODBC</em> into your <em>Plant Simulation</em> simulation model. This object establishes the connection with the database and enables you to import data from it. You can write this data into <em>Plant Simulation</em> tables, change them there and use them in your simulation runs and re-export the changed data back into the database. 
         </p>
         <ul>
            <li>
               
               <p class="para_item">To add the object <a class="links" href="id92182.html">ODBC</a>
                  <img align="bottom" src="../graphics/nonLocalized/plant_sim_help/icons/icons/odbcSm.gif" border="0"> to the toolbar <b class="uiTerm">Information Flow</b> of your simulation model, click <img align="bottom" src="../graphics/nonLocalized/plant_sim_help/icons/icons/manageCLasslibButt.gif" border="0">
                  <a class="links" href="id95750.html">Manage Class Library</a> &gt; <b class="uiTerm">Basic Objects</b> &gt;
     <b class="uiTerm">InformationFlow</b> on the <b class="uiTerm">Home</b> ribbon tab. 
               </p>
               
               <p align="center"><img align="bottom" src="../graphics/graphicLibrary/Step-by-Step_Help/ImportingDataforSimulation/addODBCE.gif"></p>
               
            </li>
         </ul>
         <p class="para_topic">Click the object on the toolbar <b class="uiTerm">Information Flow</b> and insert it into your simulation model.
         </p>
         <p class="para_topic">In our example we inserted the following objects into our simulation model:</p>
         <ul>
            <li>
               
               <p class="para_item">An <em>ODBC</em> object, which controls the communication with the database.
               </p>
               
            </li>
            <li>
               
               <p class="para_item">A <em>Method</em> for reading data from the database. 
               </p>
               
            </li>
            <li>
               
               <p class="para_item">A <em>Method</em> for writing data to the database. 
               </p>
               
            </li>
            <li>
               
               <p class="para_item">A <em>Plant Simulation</em>
                  <em>Table</em> into which we import the data, and from which we export it back to the database.
               </p>
               
               <p align="center"><img align="bottom" src="../graphics/graphicLibrary/Step-by-Step_Help/ImportingDataforSimulation/odbcEFrame.gif"></p>
               
            </li>
            <li>
               
               <p class="para_item">Double-click the object <em>ODBC</em> and type the name of the database into the text box <b class="uiTerm">Database</b>. In our example we entered <code>TestDB</code>. Note that this is the same name that we entered into the dialog <b class="uiTerm">ODBC Microsoft Access Setup</b> above.
               </p>
               
               <p class="para_item">When you use a database with user management, such as SQL-Server, Oracle, etc., you also have to enter a <b class="uiTerm">User name</b> and a <b class="uiTerm">Password</b>. To apply your changes, click <b class="uiTerm">Apply</b>.
               </p>
               
               <p class="para_item">To log on to the database, click <b class="uiTerm">Login</b>.
               </p>
               
               <table bgcolor="#FFFFFF" cellpadding="2" cellspacing="1" align="center">
                  
                  <colgroup span="1">
                     
                     <col span="1" width="50%">
                     
                     <col span="1" width="50%">
                     
                  </colgroup>
                  
                  <tbody>
                     
                     <tr>
                        
                        <td colspan="1" rowspan="1">
                           
                           <p class="para_td_last"><img align="bottom" src="../graphics/graphicLibrary/Step-by-Step_Help/ImportingDataforSimulation/odbcE2.gif" border="0"></p>
                           
                        </td>
                        
                        <td colspan="1" rowspan="1">
                           
                           <p class="para_td_last"><img align="bottom" src="../graphics/graphicLibrary/Step-by-Step_Help/ImportingDataforSimulation/odbcE21.gif" border="0"></p>
                           
                        </td>
                        
                     </tr>
                     
                  </tbody>
                  
               </table>
               
               <p class="para_item">When all your settings worked out, <em>Plant Simulation</em> grays out the box with the name of the database and shows <b class="uiTerm">OK</b> in the box <b class="uiTerm">Message</b>. When <em>Plant Simulation</em> encountered problems, it shows an error message describing the problem.
               </p>
               
            </li>
            <li>
               
               <p class="para_item">Then, insert a <em>Method</em> into your simulation model. Within this <em>Method</em> you program, which data will be imported and what happens to this data. 
               </p>
               
               <p class="para_item">Reading and writing data only works, when <em>Plant Simulation</em> is connected to the database. For this reason the methods <a class="links" href="id55837.html">login</a> and <a class="links" href="id28945.html">logout</a> frame the database operation proper.
               </p>
               
               <p class="para_item">The source code looks like this:</p>
               <pre class="indent">ODBC.login(&quot;TestDB&quot;,&quot;&quot;,&quot;&quot;)
-- database operation
ODBC.logout</pre>
               </li>
            <li>
               
               <p class="para_item">Then you can read data from the database and write the results of the database query into an <em>Plant Simulation</em> table. Instead, you could also write the data into a local variable.
               </p>
               
               <p class="para_item">You&rsquo;ll always start the query with the command .<a class="links" href="id41032.html">sql</a>. Then, define the target, in our example this is the <em>Plant Simulation</em> table <code>Orders</code>. Next, you&rsquo;ll enter SQL standard queries within quotes. The syntax you have to use depends on your database system, consult the documentation that came with your database. The ODBC driver of the database determines the range of commands you can enter. 
               </p>
               
               <p class="para_item">In our example we will read the entire contents of the table <code>Orders2</code> from our Access database and write it into the <em>Plant Simulation</em> table <code>Orders</code>.
               </p>
               
               <p align="center"><img align="bottom" src="../graphics/graphicLibrary/Step-by-Step_Help/ImportingDataforSimulation/ordersAccess.gif"></p>
               
               <p class="para_item">The source code looks like this:</p>
               <pre class="indent">ODBC.login(&quot;TestDB&quot;,&quot;&quot;,&quot;&quot;)
ODBC.sql(Orders, &quot;select * from Orders2&quot;)
ODBC.logout</pre>
               <p class="para_item">When you want to format the columns of the target table in <em>Plant Simulation</em> according to the formatting in the database while reading the data, make sure that <b class="uiTerm">Format Table</b>
                  <img align="bottom" src="../graphics/graphicLibrary/Step-by-Step_Help/ImportingDataforSimulation/formatTableE.gif" border="0"> in the dialog of the object <em>ODBC</em> is checked. This only applies, when <em>Plant Simulation</em> provides its own formats, which correspond to the formats in the database. <em>Plant Simulation</em> does, for example, not provide a counterpart for the typical date format in Oracle. The documentation of your database provides information about filters for changing formats during the query. 
               </p>
               
               <p align="center"><img align="bottom" src="../graphics/graphicLibrary/Step-by-Step_Help/ImportingDataforSimulation/odbcPlantOrders.gif"></p>
               
            </li>
            <li>
               
               <p class="para_item">You can then use and manipulate this data in <em>Plant Simulation</em> in a number of ways. When working with large amounts of data, we recommend to use SQL queries with filters, as these are oftentimes considerably faster than searching large <em>Plant Simulation</em> tables. 
               </p>
               
               <p class="para_item">In our example the query for <code>DeliveryTime</code> and <code>Amount</code> of all parts of type <code>panel</code> yields this result in our <em>Plant Simulation</em> table.
               </p>
               
               <p class="para_item">The source code looks like this:</p>
               <pre class="indent">ODBC.login(&quot;TestDB&quot;,&quot;&quot;,&quot;&quot;)
ODBC.sql(Orders, &quot;select DeliveryTime, Amount from Orders2 where MU = '.MUs.panel'&quot;)
ODBC.logout</pre>
               <p align="center"><img align="bottom" src="../graphics/graphicLibrary/Step-by-Step_Help/ImportingDataforSimulation/readDB1.gif"></p>
               
            </li>
         </ul>
         <p class="para_topic"><b class="uiTerm">Go to</b>
            <a class="links" href="id91507.html">Set the Data Source Up</a></p>
         <p class="para_topic"><b class="uiTerm">Go to</b>
            <a class="links" href="id36348.html">Export Data to the Database</a></p>
         <p class="para_topic"><b class="uiTerm">Back to</b>
            <a class="links" href="id37636.html">Import Data from an ODBC Database</a></p>
      </div>
      <div class="insideNavLinks"><span><a class="link" href="id91507.html"><img border="0" src="../../../../../../icons/previous.gif" title="Previous Page:Set the Data Source Up"></a><a class="link" href="id36348.html"><img border="0" src="../../../../../../icons/next.gif" title="Next Page:Export Data to the Database"></a></span></div>
   </body>
</html>