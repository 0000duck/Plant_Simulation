<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<!--
This software and related documentation are proprietary to Siemens Product Lifecycle Management Software Inc.

(c) 2013 Siemens Product Lifecycle Management Software Inc. All Rights Reserved. 

All trademarks belong to their respective holders.
-->
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Add a Menu and Menu Commands</title>
      
      <meta name="MS-HKWD" content="Add a Menu and Menu Commands">
      
      <link type="text/css" href="css/base.css" rel="stylesheet">
   </head>
   <body class="bodydocs" bgcolor="#FFFFFF">
      <div class="title_topic5" id="xps10_pagetitle">Add a Menu and Menu Commands</div>
      <hr noshade="true">
      <div class="insideNavLinks"><span><a class="link" href="id45562.html"><img border="0" src="../../../../../../icons/previous.gif" title="Previous Page:Design a Simple Dialog"></a><a class="link" href="id33452.html"><img border="0" src="../../../../../../icons/next.gif" title="Next Page:Add a Static Text Box"></a></span></div>
      <table align="center" class="simpleHTMLminitoc" width="95%">
         <tr>
            <td class="simpleHTMLminitoc"><span class="simpleHTMLminitoc"><a href="id13814.html">Step-by-Step Help</a></span> &gt; <span class="simpleHTMLminitoc"><a href="id18086.html">Setting Parameters in the Model</a></span> &gt; <span class="simpleHTMLminitoc"><a href="id47691.html">Set Parameters for Objects in Your Own Dialog</a></span> &gt; <span class="simpleHTMLminitoc"><a href="id45562.html">Design a Simple Dialog</a></span> &gt; <span class="simpleHTMLminitoc">Add a Menu and Menu Commands</span></td>
         </tr>
      </table>
      <div class="contentType_"><span id="ndxgenid_PlantSimulationENU_1746"></span><p class="para_topic">To add a menu to your dialog:</p>
         <ul>
            <li>
               
               <p class="para_item">Right-click on the tab <b class="uiTerm">Elements</b> and select <a class="links" href="id47642.html">New Menu/New Menu Command</a>. 
               </p>
               
            </li>
            <li>
               
               <p class="para_item">Enter the <a class="links" href="id56339.html">Name</a> of the menu. A <em>Method</em> object can call this dialog item using the <b class="uiTerm">Name</b> you entered. 
               </p>
               
            </li>
            <li>
               
               <p class="para_item">Enter the <a class="links" href="id54440.html">Caption</a>, which the menu displays. A caption is especially handy if you develop application object libraries in several languages and want the user to be able to switch languages. In addition you can enter special characters and blanks. In our example we entered <code>Show</code>. 
               </p>
               
               <div class="attention attention_note">
                  <table border="0">
                     <tr>
                        <td valign="top" align="left"><img src="graphics/note.gif" alt="Note" title="Note"></td>
                        <td valign="bottom" align="left" width="100%">
                           
                           <p class="para_note_body">For the top menu itself, you do not have to enter a <b class="uiTerm">Callback argument</b>. 
                           </p>
                           
                        </td>
                     </tr>
                  </table>
               </div>
               
               <table bgcolor="#FFFFFF" cellpadding="2" cellspacing="1" align="center">
                  
                  <colgroup span="1">
                     
                     <col span="1" width="50%">
                     
                     <col span="1" width="50%">
                     
                  </colgroup>
                  
                  <tbody>
                     
                     <tr>
                        
                        <td colspan="1" rowspan="1">
                           
                           <p class="para_td_last"><img align="bottom" src="../graphics/graphicLibrary/Step-by-Step_Help/Setting_Parameters_in_the_Model/menuShow.gif" border="0"></p>
                           
                        </td>
                        
                        <td colspan="1" rowspan="1">
                           
                           <p class="para_td_last"><img align="bottom" src="../graphics/graphicLibrary/Step-by-Step_Help/Setting_Parameters_in_the_Model/menu.gif" border="0"></p>
                           
                        </td>
                        
                     </tr>
                     
                  </tbody>
                  
               </table>
               
            </li>
         </ul>
         <p class="para_topic">To add a menu command to the menu you added above:</p>
         <ul>
            <li>
               
               <p class="para_item">Right-click the name of the menu on the tab <b class="uiTerm">Elements</b> and select <b class="uiTerm">New Menu/Menu Command</b>. 
               </p>
               
            </li>
            <li>
               
               <p class="para_item">Enter the <b class="uiTerm">Name</b> of the menu command.
               </p>
               
            </li>
            <li>
               
               <p class="para_item">Enter the <b class="uiTerm">Caption</b>, which the menu command displays. In our examples we entered <code>Chart</code> and <code>Report</code>. 
               </p>
               
               <table bgcolor="#FFFFFF" cellpadding="2" cellspacing="1" align="center">
                  
                  <colgroup span="1">
                     
                     <col span="1" width="50%">
                     
                     <col span="1" width="50%">
                     
                  </colgroup>
                  
                  <tbody>
                     
                     <tr>
                        
                        <td colspan="1" rowspan="1">
                           
                           <p class="para_td_last"><img align="bottom" src="../graphics/graphicLibrary/Step-by-Step_Help/Setting_Parameters_in_the_Model/menuChart.gif" border="0"></p>
                           
                        </td>
                        
                        <td colspan="1" rowspan="1">
                           
                           <p class="para_td_last"><img align="bottom" src="../graphics/graphicLibrary/Step-by-Step_Help/Setting_Parameters_in_the_Model/menuReport.gif" border="0"></p>
                           
                        </td>
                        
                     </tr>
                     
                  </tbody>
                  
               </table>
               
            </li>
            <li>
               
               <p class="para_item">So that the dialog opens the <em>Chart</em> or the <em>Report</em>, when the user selects <b class="uiTerm">Show</b>
    &gt; <b class="uiTerm">Chart</b> or <b class="uiTerm">Show</b>&gt;
     <b class="uiTerm">Report</b>, you have to program it to do so. For this you have to enter the <a class="links" href="id71567.html">Callback argument</a>, which will be passed to the <em>callback method</em>. In our examples we entered <code>CallbackChart</code> and <code>CallbackReport</code>. 
               </p>
               
            </li>
            <li>
               
               <p class="para_item">Then, enter the code for actually opening the <em>Chart</em> or the <em>Report</em> into the <em>callback method</em>. As the <em>callback method</em> is a user-defined attribute of data type <em>method</em>, click the tab <b class="uiTerm">User-defined Attributes</b>. 
               </p>
               
               <p align="center"><img align="bottom" src="../graphics/graphicLibrary/Step-by-Step_Help/Setting_Parameters_in_the_Model/MenuCallbackMethod1.gif"></p>
               
               <p class="para_item">Double-click <b class="uiTerm">callback</b> and click <b class="uiTerm">Open</b> in the dialog <b class="uiTerm">User-defined Attributes</b>. To be able to enter commands into the <em>Method</em>, click <b class="uiTerm">Inherit Source Code</b> on the <b class="uiTerm">Edit</b> ribbon tab of the method so that it is not selected <img align="bottom" src="../graphics/nonLocalized/plant_sim_help/icons/icons/inheritSourceCodeReleased.gif" border="0">. 
               </p>
               
               <p class="para_item">The source code looks like this:</p>
               <pre class="indent">param action: string
switch action
case &quot;Open&quot;
                -- TODO: add code for the &quot;Open&quot; action here
                -- for example ?.setCaption(&quot;TextBox&quot;, &quot;Test&quot;)
                -- for example ?.setCheckBox(&quot;CheckBox&quot;, true)
case &quot;Apply&quot;
                -- TODO: add code for the &quot;Apply&quot; action here
                -- for example print ?.getValue(&quot;TextBox&quot;)
                -- for example print ?.GetCheckBox(&quot;CheckBox&quot;)
case &quot;Close&quot;
                -- TODO: add code for the &quot;Close&quot; action here
end</pre>
               <p class="para_item">Double-click <b class="uiTerm">callback</b> and click <b class="uiTerm">Open</b> in the dialog <b class="uiTerm">User-defined Attributes</b>. 
               </p>
               
               <p class="para_item">To open the object <em>MyChart</em>, we entered:
               </p>
               <pre class="indent">case &quot;CallbackChart&quot; 
   MyChart.active := true </pre>
               <p class="para_item">To open the object <em>MyReport</em>, we entered:
               </p>
               <pre class="indent">case &quot;CallbackReport&quot; 
   MyReport.show </pre>
               <p align="center"><img align="bottom" src="../graphics/graphicLibrary/Step-by-Step_Help/Setting_Parameters_in_the_Model/menuCallbackNewSyntaxOnePicture.gif"></p>
               
            </li>
            <li>
               
               <p class="para_item">To change the order of the <b class="uiTerm">menu</b> commands on a menu, select a menu command on the tab <b class="uiTerm">Elements</b>, hold down the <b class="uiTerm">Shift</b> key and press the <b class="uiTerm">Up arrow</b> to move this menu command up or press the <b class="uiTerm">Down arrow</b> to move this menu command down. 
               </p>
               
            </li>
            <li>
               
               <p class="para_item">To add a <b class="uiTerm">submenu</b> to the selected menu command, right click that menu command and select <b class="uiTerm">New Menu/New Menu Command</b> again. Repeat the steps described above. A submenu looks like this.
               </p>
               
               <table bgcolor="#FFFFFF" cellpadding="2" cellspacing="1" align="center">
                  
                  <colgroup span="1">
                     
                     <col span="1" width="50%">
                     
                     <col span="1" width="50%">
                     
                  </colgroup>
                  
                  <tbody>
                     
                     <tr>
                        
                        <td colspan="1" rowspan="1">
                           
                           <p class="para_td_last"><img align="bottom" src="../graphics/graphicLibrary/Step-by-Step_Help/Setting_Parameters_in_the_Model/dSubmenu1.gif" border="0"></p>
                           
                        </td>
                        
                        <td colspan="1" rowspan="1">
                           
                           <p class="para_td_last"><img align="bottom" src="../graphics/graphicLibrary/Step-by-Step_Help/Setting_Parameters_in_the_Model/dSubmenu2.gif" border="0"></p>
                           
                        </td>
                        
                     </tr>
                     
                  </tbody>
                  
               </table>
               
            </li>
         </ul>
         <p class="para_topic"><b class="uiTerm">Go to</b>
            <a class="links" href="id62613.html">Program Actions which the Dialog Items Execute</a></p>
         <p class="para_topic"><b class="uiTerm">Compare</b>
            <a class="links" href="id47642.html">New Menu/New Menu Command</a> in the Plant Simulation Reference
         </p>
         <p class="para_topic"><b class="uiTerm">Back to</b>
            <a class="links" href="id45562.html">Design a Simple Dialog</a></p>
      </div>
      <div class="insideNavLinks"><span><a class="link" href="id45562.html"><img border="0" src="../../../../../../icons/previous.gif" title="Previous Page:Design a Simple Dialog"></a><a class="link" href="id33452.html"><img border="0" src="../../../../../../icons/next.gif" title="Next Page:Add a Static Text Box"></a></span></div>
   </body>
</html>